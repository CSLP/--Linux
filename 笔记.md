# Shell 笔记

### 1. 运行

* 创建test.sh 名字随便，见名知意更好，shell脚本一般.sh表明
* 开头#! /bin/bash 指定系统此脚本需要什么解释器来执行，即使用哪一种shell
* 运行shell脚本两种办法
  * 作为可执行程序./test.sh（可能写完需要加执行权限），系统调用脚本指定的解释器来执行
  * 作为解释器参数：bash test.sh 这种方式忽略脚本第一行的指定解释器信息，可以不写，写了也没用

### 2. Shell变量

##### 1.变量名要求同C++，有一点不同

* 英文字母，数字，下划线组成，首字符不能数字开头
* 不能使用关键字

* 初始化或赋值时变量和等号之间不能有空格
  
##### 2. 定义及赋值

  * 定义：无需指定类型，直接：var
  * 赋值：var="jjjjj"或var=12(只有字符串和数字两种，所以字符串的双引号可省略)
  * 可在定义时赋值var="Shell Script wudi "
##### 3. 使用变量

  * $var或${var}     eg:   echo $var, var1=$var
  
  * 不断重新赋值 
  
    ```shell
    var=helloworld
    echo $var
    var=focus
    echo $var
    var1=$var
    echo $var1
    ```

##### 4. 只读变量

  * readonly 指定，readonly 语句之后，该变量不可在赋值
  
  * ```shell
    var=helloworld
    echo $var
    var=nmsl
    echo $var
    readonly var
    var=focus  //报错，readonly变量之后，该变量不可在修改
    echo $var   
    ```

##### 5. 删除变量

  * unset var   变量删除后不可在使用
  
    * ```shell
      var=helloworld
      echo $var
      unset var
      echo $var //显示为空
      ```
  
  * unset命令不可删除只读变量
  
    * ```shell
      var=helloworld
      readonly var
      unset var  //报错
      ```

##### 6. 变量类型

  * **局部变量** 局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。
  * **环境变量** 所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。
  * **shell变量** shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行

### 3. Shell字符串

##### 1. 赋值

* 无引号

  * var=helloworld
  * 限制
    * 若字符串有空格，则必须加引号
    * `var=hello world`  报错

* 单引号

  * var='helloworld'
  * 限制：
    * 单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的
    * 单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。

* 双引号

  * var="helloworld"

  * 优点：

    * 双引号里可以有变量

    * 双引号里可以出现转义字符

    * ```shell
      var=helloworld
      str="this is $var"
      str1="this is \" nimasile \""
      echo $str  //输出this is heloworld
      echo $str1 //输出 this is "nimasile"   
      ```

##### 2. 拼接字符串

* 单引号方式

  * ```shell
    var=LP
    str1='My name is '$var' '
    str2='My name is $var'
    echo $str1 $str2
    输出：My name is LP   My name is $var
    ```

* 双引号方式

  * ```shell
    var=Lp
    str1="my name is $var"
    str2="my name is "$var""//不加转义符，忽略引号内的双引号
    str3="my name is \$var"
    echo $str1 $str2 $str3
    输出My name is Lp My name is Lp My name is $var
    ```

##### 3. 获取字符串长度

* #

  * ```sell
    var="helloworld"
    echo ${#var}
    输出：10
    ```

##### 4. 提取子字符串

* i:j  表示从下标i开始截取j个字符。（下标从0开始）

  * ```shell
    var=helloworld
    str=${var:1:2}
    echo str
    输出：el
    ```

##### 5. 查找子字符串

* expr index  被查找string 要查找的子字符串

  * ```shell
    var="You are such a bitch"
    echo `expr index $var su`//查找su，那个字符先出现查找那个
    输出：3（u在第三个位置出现，下标从1开始）
    ```

### 4. Shell数组

##### 1. 性质

* 支持一维数组
* 初始化无需定义数组大小
* 数组下标从0开始，可以不连续
* 不要求数组元素都相同

##### 2. 定义

* 数组名=(value1 value2 value3 value4)

* ```shell
  var=(1 2 3 4 5 6)
  var3=(1 2 3 nmsl 4 5)
  var1=(
  1
  2
  3
  4
  )
  var2[0]=1
  var2[1]=2
  var2[3]=4//允许下标不连续
  ```

##### 3. 读取

* ${var[i]} 读取下标为i的元素，如果var[i]不存在，什么也不干
* ${var[@]}或${var[*]} 读取所有元素（允许下标不连续）

##### 4. 获取数组长度

* ${#var[@]}或${#var[*]}获取数组长度
* ${#var[i]}获取元素var[i]的长度

### 5. 注释

##### 1. 单行：# 

* ```shell
  #加速加速加速，效率，效率，效率
  #蔡徐坤你妈死了
  #young and beautiful 真好听
  ```

##### 2. 临时注释：{}

* ```shell
  comment()
  {
  	卡发顺丰的分类的开发健康
  	的发家史开发及阿卡
  	地方开始放假	
  }
  把大段注释内容写到{}里，定义一个函数，没人调用，所以不执行，就相当于注释了，想取消直接取消函数
  ```

##### 3. 块注释

* :<<EOF     注释内容    EOF
* :<<!   注释内容     ！//推荐
* :<<'   注释内容      '

### 6. 给shell脚本传参数

##### 1. 执行时传参

* ./test.sh    1     nimasile   fjdkj jj   111

##### 2. 利用参数

* $n

  * $0  表示脚本文件名

  * $1 表示传入的第一个参数

  * $2 表示传入的第二个参数

  * 以此类推。。。。

  * ```shell
    #代码
    #!/bin/bash
    echo $0 $1 $2 $3 
    #执行
    ./test.sh 1 2 3
    输出  ./test.sh 1 2 3
    sh test.sh 1 2 3
    输出: test.sh 1 2 3
    ```

* $#

  * 传递到脚本的实际参数个数

* $$

  * 脚本运行的当前进程ID号

* $! 

  * 后台运行的最后一个进程的ID号

* $-

  * 显示Shell使用的当前选项，与[set命令](https://www.runoob.com/linux/linux-comm-set.html)功能相同

* $?

  * 显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误

* $*

  * 以一个单字符串显示所有向脚本传递的参数

* $@

  * 与$*相同，但是使用时加引号，并在引号中返回每个参数

* $* 与 $@ 区别：

  * 相同点：都是引用所有参数。
  
  * 不同点：只有在双引号中体现出来。假设在脚本运行时写了三个参数 1、2、3，，则 " * " 等价于 "1 2 3"（传递了一个参数），而 "@" 等价于 "1" "2" "3"（传递了三个参数）。
  
  * ```shell
    #代码
    #!/bin/bash
    for i in "$*";do
    	echo $i
    done
    
    for i in "$@";do
    	echo $i
    done
    ```
  
  * ```shell
    #执行
    ./test.sh 1 2 3 4 5
    #结果
    1 2 3 4 5
    1
    2
    3
    4
    5
    ```

### 7. Shell 基本运算符

##### 1.算术运算符

* 性质

  * 原生bash不支持简单数学运算，通过linux的expr命令实现整数运算

* 实现

  * | 运算符 | 举例                                    |
    | :----- | --------------------------------------- |
    | +      | var=\`expr  $a + $b`                    |
    | -      | var=\`expr  $a - $b`                    |
    | *      | var=\`expr  $a \\* $b`  注意*要用转义符 |
    | /      | var=\`expr  $a / $b`                    |
    | %      | var=\`expr  $a % $b`                    |
    | =      | a=$b                                    |
    | ==     | [ $a == $b ]                            |
    | !=     | [ $a != $b ]                            |

  * **注**

    * 上述所有表达式，都要求操作数和操作符之间有空格，除了赋值运算符。赋值运算符严格要求操作数紧挨操作符，不能有空格
    * 条件表达式在方括号中，不仅操作数操作符之前有空格且与方括号之间也得有空格
    * 本质调用终端的expr实现简单的整数运算，expr可直接在终端使用，也要求有空格

  * 示例

    * ```shell
      #!/bin/bash
      
      a=10
      b=20
      
      val=`expr $a + $b`
      echo "a + b : $val"
      
      val=`expr $a - $b`
      echo "a - b : $val"
      # 注意乘号要用转义符
      val=`expr $a \* $b`  
      echo "a * b : $val"
      
      val=`expr $b / $a`
      echo "b / a : $val"
      
      val=`expr $b % $a`
      echo "b % a : $val"
      
      if [ $a == $b ]
      then
         echo "a 等于 b"
      fi
      if [ $a != $b ]
      then
         echo "a 不等于 b"
      fi
      
      #运行结果
      a + b : 30
      a - b : -10
      a * b : 200
      b / a : 2
      b % a : 0
      a 不等于 b
      ```

##### 2. 关系运算符

* 性质

  * 只支持数字，不支持字符串，除非字符串的值是数字

* 实现

  * | 运算符 | 说明             | 举例          |
    | ------ | ---------------- | ------------- |
    | -eq    | equal ==         | [ $a -eq $b ] |
    | -ne    | not equal !=     | [ $a -ne $b ] |
    | -gt    | greater than >   | [ $a -gt $b ] |
    | -lt    | less than <      | [ $a -lt $b ] |
    | -ge    | greater equal >= | [ $a -ge $b ] |
    | -le    | less equal  <=   | [ $a -le $b ] |

    



  

  

